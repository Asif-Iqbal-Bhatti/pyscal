

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pybop.core &mdash; pybop 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'1.0.0',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> pybop
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../pybop.html">pybop package</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../extending.html">Extending and contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../helpandsupport.html">Help and support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing the code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Developers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">pybop</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>pybop.core</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pybop.core</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pybop.ccore</span> <span class="k">as</span> <span class="nn">pc</span>
<span class="kn">import</span> <span class="nn">pybop.traj_process</span> <span class="k">as</span> <span class="nn">ptp</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Definitions of class Atom.</span>

<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="Atom"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom">[docs]</a><span class="k">class</span> <span class="nc">Atom</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A c++ class for holding the properties of a single atom. Various properties of the atom</span>
<span class="sd">    can be accessed through member functions which are described below in detail. Atoms can</span>
<span class="sd">    be created individually or directly by reading in a file. Check the examples for more </span>
<span class="sd">    details on how atoms are created. For creating atoms directly from an input file check</span>
<span class="sd">    the documentation of `System` class.</span>

<span class="sd">    Although an `Atom` object can be created independently, Atoms should be thought of </span>
<span class="sd">    inherently as members of the `System` class. All the properties that define an `atom` are</span>
<span class="sd">    relative to the `System` class. `System` has a list of all atoms using which the neighbors</span>
<span class="sd">    of an atom, if its solid and so on can be calculated. All the calculated properties of an</span>
<span class="sd">    atom which depend on any other atom hence should be calculated through `System`. Please</span>
<span class="sd">    check the examples section of the documentation for more details. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    pos : list of floats of length 3, default [0,0,0]</span>
<span class="sd">        position of the `Atom`</span>

<span class="sd">    id : int, default 0</span>
<span class="sd">        id of the `Atom`</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; #method 1 - individually</span>
<span class="sd">    &gt;&gt;&gt; atom = Atom()</span>
<span class="sd">    &gt;&gt;&gt; #now set positions of the atoms</span>
<span class="sd">    &gt;&gt;&gt; atom.set_x([23.0, 45.2, 34.2])</span>
<span class="sd">    &gt;&gt;&gt; #now set id</span>
<span class="sd">    &gt;&gt;&gt; atom.set_id(23)</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    get_x</span>
<span class="sd">    set_x</span>
<span class="sd">    set_id</span>
<span class="sd">    get_id</span>
<span class="sd">    System</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deafults args</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>     
        <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>

    <span class="c1">#now wrapping for other normal functions</span>
<div class="viewcode-block" id="Atom.get_x"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_x">[docs]</a>    <span class="k">def</span> <span class="nf">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Get the position of the atom. Meaningful values are only returned if the atoms are</span>
<span class="sd">        set before using this function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        x : array of float</span>
<span class="sd">            contains the position of the atom in the form [posx, posy, posz], where</span>
<span class="sd">            posx is the x coordinate of the atom, posy is the y coordinate and posz </span>
<span class="sd">            is the z coordinate. </span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; atom = Atom()</span>
<span class="sd">        &gt;&gt;&gt; x = atom.get_x()</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        set_x</span>
<span class="sd">        Atom</span>
<span class="sd">        System      </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_x</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span></div>

<div class="viewcode-block" id="Atom.set_x"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.set_x">[docs]</a>    <span class="k">def</span> <span class="nf">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Set the position of the atom. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : list of floats of length 3</span>
<span class="sd">            list contains three values which are the position coordinates of the atom with</span>
<span class="sd">            respect to the simulation box.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; atom = Atom()</span>
<span class="sd">        &gt;&gt;&gt; x = atom.set_x([23.0, 45.2, 34.2])</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        get_x</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.get_volume"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_volume">[docs]</a>    <span class="k">def</span> <span class="nf">get_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">averaged</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Get the voronoi colume of the atom. Meaningful values are only returned if the neighbors</span>
<span class="sd">        are calculated using voronoi method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        averaged : bool, default False</span>
<span class="sd">            If True, averaged version of the volume is returned.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        volume : float</span>
<span class="sd">            voronoi volume of the atom.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; volume = atom.get_volume()</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        find_neighbors</span>
<span class="sd">        Atom</span>
<span class="sd">        System      </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">averaged</span><span class="p">:</span>
            <span class="n">vol</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_avgvolume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>    
            <span class="n">vol</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_volume</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">vol</span></div>

<div class="viewcode-block" id="Atom.get_cluster"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_cluster">[docs]</a>    <span class="k">def</span> <span class="nf">get_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the cluster properties of the atom. The cluster properties of the atom</span>
<span class="sd">        include four different properties as listed below. The properties are only</span>
<span class="sd">        returned if they are calculated before using &#39;calculate_nucsize&#39; function </span>
<span class="sd">        before.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cluster : list of int of length 4</span>
<span class="sd">            cluster is a vector of four values. they are described below-</span>
<span class="sd">                issolid - which is 1 if the atom is solid, 0 otherwise</span>
<span class="sd">                issurface - 1 if the atom has liquid neighbors, 0 otherwise</span>
<span class="sd">                lcluster - 1 if the atom belongs to the largest cluster, 0 otherwise</span>
<span class="sd">                belongsto - which gives the id of the cluster that the atom belongs to.</span>
<span class="sd">        </span>
<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; cinfo = atom.get_cluster()</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        set_nucsize_parameters</span>
<span class="sd">        calculate_nucsize</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span></div>

<div class="viewcode-block" id="Atom.get_neighbors"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_neighbors">[docs]</a>    <span class="k">def</span> <span class="nf">get_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Returns the neighbors indices of the atom. The list returned consistes of the indices</span>
<span class="sd">        of neighbor atom which indicate their position in the list of all atoms. The neighbors</span>
<span class="sd">        of an atom can be calculated from the `System` object that it belongs to.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        x : list of int</span>
<span class="sd">            list of neighbor indices of the atom.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        neighbors = atom.get_neighbors()</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        set_neighbors</span>
<span class="sd">        set_neighborweights</span>
<span class="sd">        get_neighborweights</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.set_neighbors"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.set_neighbors">[docs]</a>    <span class="k">def</span> <span class="nf">set_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">neighs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Set the neighbors of an atom manually.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        neighs : list of ints</span>
<span class="sd">            index of the neighbor atoms </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        atom.set_neighbors([0,23,11,22,334,112,11])</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        get_neighbors</span>
<span class="sd">        set_neighborweights</span>
<span class="sd">        get_neighborweights</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">neighs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Atom.get_coordination"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_coordination">[docs]</a>    <span class="k">def</span> <span class="nf">get_coordination</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Returns the coordination number of the atom. `get_allneighbors` function of the `System` class</span>
<span class="sd">        has to be used before accessing coordination numbers. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cn : int</span>
<span class="sd">            coordination number of the atom.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        neighbors = atom.get_neighbors()</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        set_neighbors</span>
<span class="sd">        set_neighborweights</span>
<span class="sd">        get_neighborweights</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_coordination</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.get_neighborweights"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_neighborweights">[docs]</a>    <span class="k">def</span> <span class="nf">get_neighborweights</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Get the neighbor weights of the atom. The neighbor weights are used weight the </span>
<span class="sd">        contribution of each neighboring atom towards the q value of the host atom. By </span>
<span class="sd">        default, each neighbor has a weight of 1 each. However, if the neighbors are calculated</span>
<span class="sd">        using the `System.get_allneighbors(method=&#39;voronoi&#39;)`, each neighbor atom gets a </span>
<span class="sd">        weight proportional to the face area shared between the neighboring atom and the </span>
<span class="sd">        host atom. This can sometimes be helpful in controlling the contribution of atoms</span>
<span class="sd">        with low face areas due to the thermal vibrations at high temperature.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        x : list of float</span>
<span class="sd">            neighbor weights</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; weights = atom.get_neighborweights()</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        get_neighbors</span>
<span class="sd">        set_neighbors</span>
<span class="sd">        set_neighborweights</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_neighborweights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.set_neighborweights"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.set_neighborweights">[docs]</a>    <span class="k">def</span> <span class="nf">set_neighborweights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Set the neighbor weights of an atom.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        weights : list of floats </span>
<span class="sd">            weights of the neighbor atoms </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; atom.set_neighborweights([0.1, 0.2, 0.2, 0.4, 0.1])</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        get_neighbors</span>
<span class="sd">        set_neighbors</span>
<span class="sd">        set_neighborweights</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_neighborweights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.get_q"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_q">[docs]</a>    <span class="k">def</span> <span class="nf">get_q</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">averaged</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get q value of the atom. The q value can be either normal or can</span>
<span class="sd">        be averaged according to Lechner, W, Dellago, C. JCP 129, 2008.</span>
<span class="sd">        The averaged version can be obtained by using keyword</span>
<span class="sd">        `averaged = True`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q : int or list of int</span>
<span class="sd">            number of the required q - from 2-12</span>

<span class="sd">        averaged : bool, default False</span>
<span class="sd">            If True, return the averaged q values,</span>
<span class="sd">            If False, return the non averaged ones</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        q : float or list of floats</span>
<span class="sd">            The queried q value</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; q2 = atom.get_q(2, averaged = True)</span>
<span class="sd">        &gt;&gt;&gt; q24 = atom.get_q([2, 4])</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        set_q</span>
<span class="sd">        get_aq</span>
<span class="sd">        set_aq      </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">averaged</span><span class="p">:</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_aq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_q</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rq</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">averaged</span><span class="p">:</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="p">[</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_aq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qq</span><span class="p">)</span> <span class="k">for</span> <span class="n">qq</span> <span class="ow">in</span> <span class="n">q</span> <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="p">[</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_q</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qq</span><span class="p">)</span> <span class="k">for</span> <span class="n">qq</span> <span class="ow">in</span> <span class="n">q</span> <span class="p">]</span>
            <span class="k">return</span> <span class="n">rq</span></div>

<div class="viewcode-block" id="Atom.set_q"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.set_q">[docs]</a>    <span class="k">def</span> <span class="nf">set_q</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">averaged</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set the q value of the atom. If `averaged = True`, sets the averaged versions of</span>
<span class="sd">        the q parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q : int or list of ints</span>
<span class="sd">            number of the required q - from 2-12</span>
<span class="sd">        d : float or list of floats</span>
<span class="sd">            the q value to set</span>
<span class="sd">        averaged : bool, default False</span>
<span class="sd">            If True, return the averaged q values,</span>
<span class="sd">            If False, return the non averaged ones            </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; atom.set_q(2, 0.24, averaged = True)</span>
<span class="sd">        &gt;&gt;&gt; atom.set_q([2,4], [0.24, 0.05])</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        set_aq</span>
<span class="sd">        get_aq</span>
<span class="sd">        get_q</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">averaged</span><span class="p">:</span>
                <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_aq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_q</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">averaged</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">qq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
                    <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_aq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qq</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">count</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">qq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">q</span><span class="p">):</span>
                    <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_q</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qq</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">count</span><span class="p">])</span></div>


<div class="viewcode-block" id="Atom.get_id"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_id">[docs]</a>    <span class="k">def</span> <span class="nf">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        get  the id of the atom.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        id : int</span>
<span class="sd">            id of the atom</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; id = atom.get_id()</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        set_id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.set_id"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.set_id">[docs]</a>    <span class="k">def</span> <span class="nf">set_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        set  the id of the atom.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idd : int</span>
<span class="sd">            id of the atom</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; atom.set_id(2)</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        get_id</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idd</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.get_loc"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_loc">[docs]</a>    <span class="k">def</span> <span class="nf">get_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        get  the location of the atom.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        loc : int</span>
<span class="sd">            loc of the atom</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; loc = atom.get_loc()</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        set_loc</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.set_loc"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.set_loc">[docs]</a>    <span class="k">def</span> <span class="nf">set_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idd</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        set  the loc of the atom.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        idd : int</span>
<span class="sd">            loc of the atom</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; atom.set_loc(2)</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        get_loc</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_loc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idd</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.get_type"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_type">[docs]</a>    <span class="k">def</span> <span class="nf">get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        get  the type(species) of the atom.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        type : int</span>
<span class="sd">            species/type of the atom</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; t = atom.get_type()</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        set_type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Atom.set_type"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.set_type">[docs]</a>    <span class="k">def</span> <span class="nf">set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tt</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        set  the type of the atom.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        tt : int</span>
<span class="sd">            type of the atom</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; atom.set_type(2)</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        get_type</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">set_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tt</span><span class="p">)</span></div>


<div class="viewcode-block" id="Atom.get_vorovector"><a class="viewcode-back" href="../../pybop.html#pybop.core.Atom.get_vorovector">[docs]</a>    <span class="k">def</span> <span class="nf">get_vorovector</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        get the voronoi structure identification vector. Returns a</span>
<span class="sd">        vector of the form (n3, n4, n5, n6), where n3 is the number</span>
<span class="sd">        of faces with 3 vertices, n4 is the number of faces with 4</span>
<span class="sd">        vertices and so on. This can be used to identify structures.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        vorovector : array like, int</span>
<span class="sd">            array of the form (n3, n4, n5, n6)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="o">.</span><span class="n">get_vorovector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div></div>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">System class definitions</span>
<span class="sd">&quot;&quot;&quot;</span>
<div class="viewcode-block" id="System"><a class="viewcode-back" href="../../pybop.html#pybop.core.System">[docs]</a><span class="k">class</span> <span class="nc">System</span><span class="p">(</span><span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A c++ class for holding the properties of a system. A `System` consists of two</span>
<span class="sd">    major components - the simulation box and the atoms. All the associated variables</span>
<span class="sd">    are then calculated over these.</span>

<span class="sd">    A `System` can be set and populated by reading an input file in lammps dump format.</span>
<span class="sd">    This enables for automatic reading of all atomic positions and the simulation box.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; sys = System()</span>
<span class="sd">    &gt;&gt;&gt; sys.read_inputfile()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

<div class="viewcode-block" id="System.read_inputfile"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.read_inputfile">[docs]</a>    <span class="k">def</span> <span class="nf">read_inputfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;lammps-dump&quot;</span><span class="p">,</span> <span class="n">frame</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">compressed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Read input file containing the information of a time slice from a molecular dynamics</span>
<span class="sd">        simulation. </span>
<span class="sd">        </span>
<span class="sd">        The format of the input file is specified using the `format` keyword. Currently only</span>
<span class="sd">        a `lammps-dump` file is supported. However, this restriction can easily be overcome </span>
<span class="sd">        using the `assign_particles` method from system where a list of atoms and box vectors </span>
<span class="sd">        are directly provided to the system.</span>

<span class="sd">        `use_c` is no deprecated and no longer used to ease transition to python 3. </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : string</span>
<span class="sd">            name of the input file to be read in</span>

<span class="sd">        format : string, `lammps-dump` or `poscar`</span>
<span class="sd">            format of the input file</span>

<span class="sd">        compressed : bool, default False</span>
<span class="sd">            If True, force to read a `gz` compressed format. However, if a file ends with `.gz`</span>
<span class="sd">            extension, it is automatically treated as a compressed file and this keyword is not</span>
<span class="sd">            necessary</span>

<span class="sd">        frame : int</span>
<span class="sd">            If the trajectory contains more than one time slice, the slice can be specified</span>
<span class="sd">            using the `frame` option. Alert: works only with `lammps-dump` format. </span>

<span class="sd">        use_c : bool, default False, deprecated</span>
<span class="sd">            If True, use the `read_particle_file` method from c++ module. This might be faster</span>
<span class="sd">            but only accepts file format of `lammps-dump` type with a particular header layout.</span>
<span class="sd">            Also `compressed` keyword doesnt work anymore. This keyword is deprecated and only</span>
<span class="sd">            kept for compatibility reasons. Use of this keyword is not recommended.</span>


<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        assign_particles</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;lammps-dump&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">frame</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="c1">#split the traj and returns set of filenames</span>
                <span class="n">filenames</span> <span class="o">=</span> <span class="n">ptp</span><span class="o">.</span><span class="n">split_traj_lammps_dump</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="n">compressed</span><span class="p">)</span>
                <span class="c1">#reassign filename</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">filenames</span><span class="p">[</span><span class="n">frame</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                    <span class="n">atoms</span><span class="p">,</span> <span class="n">boxdims</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="n">triclinic</span> <span class="o">=</span> <span class="n">ptp</span><span class="o">.</span><span class="n">read_lammps_dump</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="n">compressed</span><span class="p">,</span> <span class="n">check_triclinic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">box_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">assign_particles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">boxdims</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">triclinic</span><span class="p">:</span>
                        <span class="c1">#we have to input rotation matrix and the inverse rotation matrix</span>
                        <span class="n">rot</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">T</span>
                        <span class="n">rotinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">rot</span><span class="p">)</span>
                        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">assign_triclinic_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">rotinv</span><span class="p">)</span>
                <span class="c1">#now remove filenames</span>
                <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                <span class="n">atoms</span><span class="p">,</span> <span class="n">boxdims</span><span class="p">,</span> <span class="n">box</span><span class="p">,</span> <span class="n">triclinic</span> <span class="o">=</span> <span class="n">ptp</span><span class="o">.</span><span class="n">read_lammps_dump</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="n">compressed</span><span class="p">,</span> <span class="n">check_triclinic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">box_vectors</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">assign_particles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">boxdims</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">triclinic</span><span class="p">:</span>
                    <span class="c1">#we have to input rotation matrix and the inverse rotation matrix</span>
                    <span class="n">rot</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">T</span>
                    <span class="n">rotinv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">rot</span><span class="p">)</span>
                    <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">assign_triclinic_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">rotinv</span><span class="p">)</span>
                
        <span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;poscar&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
                <span class="n">atoms</span><span class="p">,</span> <span class="n">boxdims</span> <span class="o">=</span> <span class="n">ptp</span><span class="o">.</span><span class="n">read_poscar</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="n">compressed</span><span class="p">)</span>
                <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">assign_particles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">boxdims</span><span class="p">)</span></div>


<div class="viewcode-block" id="System.assign_atoms"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.assign_atoms">[docs]</a>    <span class="k">def</span> <span class="nf">assign_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">box</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Assign atoms directly. Receive a vector of atom objects which is stored instead</span>
<span class="sd">        of reading in the input file. If this method is used, there is no need of using</span>
<span class="sd">        `read_inputfile` method. Also using this function allows for reading of multiple</span>
<span class="sd">        file formats which are not supported by the inbuilt `read_inputfile` method.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atoms : list of `Atom` objects</span>
<span class="sd">            list consisting of all atoms</span>
<span class="sd">        box   : list of list of floats</span>
<span class="sd">            list which consists of the box dimensions in the format-</span>
<span class="sd">            [[box_x_low, box_x_high], [box_y_low, box_y_high], [box_z_low, box_z_high]]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        read_inputfile</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">assign_particles</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">,</span> <span class="n">box</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.calculate_rdf"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.calculate_rdf">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_rdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">histobins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">histomin</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">histomax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the radial distribution function. It is calculated by finding distances</span>
<span class="sd">        between all pairs of atoms and then creating a histogram from it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        histobins : int</span>
<span class="sd">            number of bins in the histogram</span>
<span class="sd">        histomin : float, optional</span>
<span class="sd">            minimum value of the distance histogram, if not specified, 0.0 is taken as the</span>
<span class="sd">            minimum.</span>
<span class="sd">        histomax : float, optional</span>
<span class="sd">            maximum value of the distance histogram. If not specified, the maximum value</span>
<span class="sd">            in all pair distances is used.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        rdf : array of ints</span>
<span class="sd">            Radial distribution function</span>
<span class="sd">        r : array of floats</span>
<span class="sd">            radius in distance units</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">distances</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_pairdistances</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">histomax</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">histomax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>

        <span class="n">hist</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">distances</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">histobins</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="n">histomin</span><span class="p">,</span> <span class="n">histomax</span><span class="p">))</span>
        <span class="n">edgewidth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">bin_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">bin_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">hist</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">bin_edges</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1">#get box density</span>
        <span class="n">boxvecs</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_boxvecs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">vol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">boxvecs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">boxvecs</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">boxvecs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">natoms</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_nop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">rho</span> <span class="o">=</span> <span class="n">natoms</span><span class="o">/</span><span class="n">vol</span>

        <span class="n">shell_vols</span> <span class="o">=</span> <span class="p">(</span><span class="mf">4.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="p">((</span><span class="n">r</span><span class="o">+</span><span class="n">edgewidth</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">-</span> <span class="n">r</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">shell_rho</span> <span class="o">=</span> <span class="n">hist</span><span class="o">/</span><span class="n">shell_vols</span>
        <span class="c1">#now divide to get final value</span>
        <span class="n">rdf</span> <span class="o">=</span> <span class="n">shell_rho</span><span class="o">/</span><span class="n">rho</span>

        <span class="k">return</span> <span class="n">rdf</span><span class="p">,</span> <span class="n">r</span></div>



<div class="viewcode-block" id="System.get_largestcluster"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.get_largestcluster">[docs]</a>    <span class="k">def</span> <span class="nf">get_largestcluster</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get id of the the largest cluster. id is only available if the largest cluster has already</span>
<span class="sd">        been found. Otherwise it returns the default values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        clusterid : int </span>
<span class="sd">            id of the largest cluster</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        get_allneighbors</span>
<span class="sd">        calculate_nucsize</span>
<span class="sd">        set_nucsize_parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_largestcluster</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.set_nucsize_parameters"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.set_nucsize_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">set_nucsize_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">minfrenkel</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">avgthreshold</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the value of parameters for calculating the largest solid cluster in the</span>
<span class="sd">        liquid, a detailed description of the order parameter can be found in  </span>
<span class="sd">        Diaz Leines et al, JCP 146(2017). http://doi.org/10.1063/1.4980082.</span>

<span class="sd">        The number of atoms in the largest solid cluster in liquid is often used as an</span>
<span class="sd">        order parameter in the study of nucleation during solidification. In order to</span>
<span class="sd">        actually calculate the largest solid cluster, `calculate_nucsize` has to be </span>
<span class="sd">        called after setting the parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cutoff : float</span>
<span class="sd">            cutoff distance for calculating neighbors</span>

<span class="sd">        minfrenkel : int</span>
<span class="sd">            Minimum number of solid bonds for an atom to be identified as</span>
<span class="sd">            a solid.</span>
<span class="sd">        </span>
<span class="sd">        threshold : double</span>
<span class="sd">            The cutoff value of connection between two atoms for them to be def</span>
<span class="sd">            ined as having a bond.</span>
<span class="sd">        </span>
<span class="sd">        avgthreshold : double</span>
<span class="sd">            Averaged value of connection between an atom and its neighbors for </span>
<span class="sd">            an atom to be solid. This threshold is known to improve the solid-liquid</span>
<span class="sd">            distinction in interfaces between solid and liquid. </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        calculate_nucsize</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; st.set_nucsize_parameters(7,0.5,0.5)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">set_nucsize_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">,</span> <span class="n">minfrenkel</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">avgthreshold</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.calculate_nucsize"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.calculate_nucsize">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_nucsize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the size of the largest cluster in the given system. Calculation</span>
<span class="sd">        the size of the largest cluster needs various prerequisites that can be set</span>
<span class="sd">        by the functions `set_nucsize_parameters`. A detailed description of the order </span>
<span class="sd">        parameter can be found in Diaz Leines et al, JCP 146(2017). </span>
<span class="sd">        http://doi.org/10.1063/1.4980082.</span>

<span class="sd">        The number of atoms in the largest solid cluster in liquid is often used as an</span>
<span class="sd">        order parameter in the study of nucleation during solidification.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cluster size : int</span>
<span class="sd">            size of the largest solid cluster in liquid (number of atoms)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">calculate_nucsize</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.get_atom"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.get_atom">[docs]</a>    <span class="k">def</span> <span class="nf">get_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Get the `Atom` object at the queried position in the list of all atoms</span>
<span class="sd">        in the `System`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int</span>
<span class="sd">            index of required atom in the list of all atoms.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        atom : Atom object</span>
<span class="sd">            atom object at the queried position.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atomc</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_catom_to_atom</span><span class="p">(</span><span class="n">atomc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">atom</span></div>

<div class="viewcode-block" id="System.set_atom"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.set_atom">[docs]</a>    <span class="k">def</span> <span class="nf">set_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Return the atom to its original location after modification. For example, an</span>
<span class="sd">        `Atom` at location `i` in the list of all atoms in `System` can be queried by,</span>
<span class="sd">        `atom = System.get_atom(i)`, then any kind of modification, for example, the </span>
<span class="sd">        position of the `Atom` can done by, `atom.set_x([2.3, 4.5, 4.5])`. After </span>
<span class="sd">        modification, the `Atom` can be set back to its position in `System` by</span>
<span class="sd">        `System.set_atom(atom)`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atom : Atom</span>
<span class="sd">                atom to be replaced</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atomc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_atom_to_catom</span><span class="p">(</span><span class="n">atom</span><span class="p">)</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">set_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atomc</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.get_allatoms"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.get_allatoms">[docs]</a>    <span class="k">def</span> <span class="nf">get_allatoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Get a list of all `Atom` objects that belong to the system.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        allatoms : list of `Atom` objects</span>
<span class="sd">            all atoms in the system</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atomcs</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_allatoms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">copy_catom_to_atom</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">atomcs</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">atoms</span></div>

<div class="viewcode-block" id="System.get_box"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.get_box">[docs]</a>    <span class="k">def</span> <span class="nf">get_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box_vectors</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Get the dimensions of the simulation box.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        box_vectors : bool, default False</span>
<span class="sd">            If True, return the whole box dimesions.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        boxdims : list of box dimensions</span>
<span class="sd">            If `box_vectors` is false:</span>
<span class="sd">            the return value consists of the vector of values in the form-</span>
<span class="sd">            [[box_x_low, box_x_high], [box_y_low, box_y_high], [box_z_low, box_z_high]]</span>
<span class="sd">            If `box_vectors` is true:</span>
<span class="sd">            return the box vectors of the form</span>
<span class="sd">            [[x1, x2, x3], [y1, y2, y3], [z1, z2, z3]]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">box_vectors</span><span class="p">:</span>
            <span class="n">box6dim</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_box</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">pbox</span> <span class="o">=</span> <span class="p">[[</span><span class="n">box6dim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">box6dim</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">box6dim</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">box6dim</span><span class="p">[</span><span class="mi">3</span><span class="p">]],</span> <span class="p">[</span><span class="n">box6dim</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">box6dim</span><span class="p">[</span><span class="mi">5</span><span class="p">]]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pbox</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_boxvecs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pbox</span></div>

<div class="viewcode-block" id="System.set_box"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.set_box">[docs]</a>    <span class="k">def</span> <span class="nf">set_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Set the dimensions of the simulation box.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        boxdims : list of box dimensions of length 6</span>
<span class="sd">            the return value consists of the vector of values in the form-</span>
<span class="sd">            [[box_x_low, box_x_high], [box_y_low, box_y_high], [box_z_low, box_z_high]]</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">set_box</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">box</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.get_qvals"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.get_qvals">[docs]</a>    <span class="k">def</span> <span class="nf">get_qvals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">averaged</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the required q values of all atoms. The function returns a list of </span>
<span class="sd">        q values in the same order as that of the atoms in the system.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        q : int or list of ints</span>
<span class="sd">            required q value from 2-12</span>
<span class="sd">        averaged : bool, default False</span>
<span class="sd">            If True, return the averaged q values,</span>
<span class="sd">            If False, return the non averaged ones </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        qvals : list of floats</span>
<span class="sd">            list of qvalue of all atoms.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">averaged</span><span class="p">:</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_aqvals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_qvals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">rq</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">averaged</span><span class="p">:</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="p">[</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_aqvals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qq</span><span class="p">)</span> <span class="k">for</span> <span class="n">qq</span> <span class="ow">in</span> <span class="n">q</span> <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rq</span> <span class="o">=</span> <span class="p">[</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_qvals</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qq</span><span class="p">)</span> <span class="k">for</span> <span class="n">qq</span> <span class="ow">in</span> <span class="n">q</span> <span class="p">]</span>
            <span class="k">return</span> <span class="n">rq</span></div>

<div class="viewcode-block" id="System.get_distance"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.get_distance">[docs]</a>    <span class="k">def</span> <span class="nf">get_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom1</span><span class="p">,</span> <span class="n">atom2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the distance between two atoms.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atom1 : `Atom` object</span>
<span class="sd">                first atom</span>
<span class="sd">        atom2 : `Atom` object</span>
<span class="sd">                second atom</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        distance : double</span>
<span class="sd">                distance between the first and second atom.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atom1c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_atom_to_catom</span><span class="p">(</span><span class="n">atom1</span><span class="p">)</span>
        <span class="n">atom2c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy_atom_to_catom</span><span class="p">(</span><span class="n">atom2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_absdistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom1c</span><span class="p">,</span> <span class="n">atom2c</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.get_neighbors"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.get_neighbors">[docs]</a>    <span class="k">def</span> <span class="nf">get_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;cutoff&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nlimit</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1.21</span><span class="p">,</span> <span class="nb">filter</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Find neighbors of all atoms in the `System`. There are few methods to do this, the </span>
<span class="sd">        traditional approach being the one in which the neighbors of an atom are the ones that lie</span>
<span class="sd">        in a cutoff distance around it. The second approach is using Voronoi polyhedra. All the atoms</span>
<span class="sd">        that share a Voronoi polyhedra face with the host atoms are considered its neighbors.</span>

<span class="sd">        Finally there is also an adaptive cutoff method if `cutoff` is specified as `&#39;adaptive&#39;` or 0. </span>
<span class="sd">        In this method, the six closest atoms to the</span>
<span class="sd">        host atom are found and a cutoff distance is determined as threshold*(1/nlimit)*sum(r_ij).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method : `cutoff` or `voronoi` or `adaptive-cutoff`, default: `cutoff`</span>
<span class="sd">            `cutoff` method finds atoms within a specified cutoff distance of the host atom</span>
<span class="sd">            `voronoi` method finds atoms that share a Voronoi polyhedra face with the host atom.</span>

<span class="sd">        cutoff : float or `adaptive`</span>
<span class="sd">            the cutoff distance to be used for the `cutoff` based neighbor calculation method</span>
<span class="sd">            described above.</span>
<span class="sd">            If the value is specified as 0 or `&#39;adaptive&#39;`, the `adaptive-cutoff` method is used.</span>
<span class="sd">        </span>
<span class="sd">        nlimit : int</span>
<span class="sd">            only used if `cutoff=&#39;adaptive&#39;`. The number of atoms used to calculate the adaptive</span>
<span class="sd">            cutoff.</span>

<span class="sd">        threshold : float</span>
<span class="sd">            only used if `cutoff=&#39;adaptive&#39;`. The threshold for the adaptive cutoff. If the average</span>
<span class="sd">            distance between host atom and `nlimit` neighbors of it is `a`, and `threshold` is 2, then</span>
<span class="sd">            host atom will have neighbors between `a` and `2a`.</span>

<span class="sd">        filter : string - `None` or `type`, default None</span>
<span class="sd">            apply a filter to nearest neighbor calculation. If the `filter` keyword is set to</span>
<span class="sd">            `type`, only atoms of the same type would be included in the neighbor calculations. </span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        reset_allneighbors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#first reset all neighbors</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reset_allneighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">set_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">filter</span> <span class="o">==</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span>
            <span class="c1"># type corresponds to 1</span>
            <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">set_filter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;cutoff&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cutoff</span><span class="o">==</span><span class="s1">&#39;adaptive&#39;</span> <span class="ow">or</span> <span class="n">cutoff</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_all_neighbors_adaptive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nlimit</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>    
                <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">set_neighbordistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">)</span>
                <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_all_neighbors_normal</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;voronoi&#39;</span><span class="p">:</span>
            <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">get_all_neighbors_voronoi</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>
            

<div class="viewcode-block" id="System.reset_neighbors"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.reset_neighbors">[docs]</a>    <span class="k">def</span> <span class="nf">reset_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Reset the neighbors of all atoms in the system. This should be used before recalculating neighbors</span>
<span class="sd">        with two different approaches.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        get_allneighbors</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">reset_allneighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.calculate_q"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.calculate_q">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_q</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">averaged</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the bond order parameter q for all atoms. Any of the q parameters from 2-12 can be provided.</span>
<span class="sd">        If the averaged versions are to be calculated, the keyword `averaged = True` should be set.</span>
<span class="sd">        See Lechner, Dellago, JCP 129, 2008. for a description of the</span>
<span class="sd">        averaged bond order parameters.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        qs : int or list of ints</span>
<span class="sd">            A list of all q params to be found from 2-12. </span>
<span class="sd">        averaged : bool, default False</span>
<span class="sd">            If True, return the averaged q values,</span>
<span class="sd">            If False, return the non averaged ones </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">qq</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">qq</span> <span class="o">=</span> <span class="n">q</span>
            
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">calculate_q</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qq</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">averaged</span><span class="p">:</span>
            <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">calculate_aq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">qq</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.calculate_frenkelnumbers"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.calculate_frenkelnumbers">[docs]</a>    <span class="k">def</span> <span class="nf">calculate_frenkelnumbers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find frenkel numbers of all atoms in the system. Frenkel number is the number of solid</span>
<span class="sd">        neighbors that an atom has. A solid bond is considered between two atoms if the connection</span>
<span class="sd">        betweem them is greater than 0.6.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        get_number_from_bond</span>
<span class="sd">        find_clusters</span>
<span class="sd">        find_largest_cluster</span>
<span class="sd">        set_nucsize_parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">calculate_frenkelnumbers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.find_clusters"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.find_clusters">[docs]</a>    <span class="k">def</span> <span class="nf">find_clusters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the clusters of all atoms in the system. Go through all the atoms and cluster them</span>
<span class="sd">        together.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        calculate_frenkelnumbers</span>
<span class="sd">        get_number_from_bond</span>
<span class="sd">        find_largest_cluster</span>
<span class="sd">        set_nucsize_parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">find_clusters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.find_largest_cluster"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.find_largest_cluster">[docs]</a>    <span class="k">def</span> <span class="nf">find_largest_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the largest solid cluster of atoms in the system from all the clusters. `find_clusters`</span>
<span class="sd">        has to be used before using this function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        cluster : int</span>
<span class="sd">            the size of the largest cluster</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        calculate_frenkelnumbers</span>
<span class="sd">        find_clusters</span>
<span class="sd">        get_number_from_bond</span>
<span class="sd">        set_nucsize_parameters</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">pc</span><span class="o">.</span><span class="n">System</span><span class="o">.</span><span class="n">find_largest_cluster</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="System.copy_catom_to_atom"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.copy_catom_to_atom">[docs]</a>    <span class="k">def</span> <span class="nf">copy_catom_to_atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atomc</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used to copy a C++ `Atom` object to python `Atom` object.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atomc : C++ `Atom` object</span>
<span class="sd">            the input atom</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        atom : python `Atom` object</span>
<span class="sd">            output atom</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atom</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">()</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_x</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_cluster</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_cluster</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_neighbors</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_neighbors</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_neighborweights</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_neighborweights</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_allq</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_allq</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_allaq</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_allaq</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_id</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_loc</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_loc</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_type</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_type</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_vorovector</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_vorovector</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_volume</span><span class="p">())</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">set_avgvolume</span><span class="p">(</span><span class="n">atomc</span><span class="o">.</span><span class="n">get_avgvolume</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">atom</span></div>

<div class="viewcode-block" id="System.copy_atom_to_catom"><a class="viewcode-back" href="../../pybop.html#pybop.core.System.copy_atom_to_catom">[docs]</a>    <span class="k">def</span> <span class="nf">copy_atom_to_catom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used to copy a python `Atom` object to C++ `Atom` object.</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        atom : python `Atom` object</span>
<span class="sd">            output atom</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        atomc : C++ `Atom` object</span>
<span class="sd">            the input atom</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">atomc</span> <span class="o">=</span> <span class="n">pc</span><span class="o">.</span><span class="n">Atom</span><span class="p">()</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_x</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_x</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_cluster</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_cluster</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_neighbors</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_neighbors</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_neighborweights</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_neighborweights</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_allq</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_allq</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_allaq</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_allaq</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_id</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_id</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_loc</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_loc</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_type</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_type</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_vorovector</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_vorovector</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_volume</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_volume</span><span class="p">())</span>
        <span class="n">atomc</span><span class="o">.</span><span class="n">set_avgvolume</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="n">get_avgvolume</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">atomc</span></div></div>
































    







</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Sarath Menon, Grisell Diaz Leines, Jutta Rogal

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>