\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage[]{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage[unicode=true]{hyperref}
\hypersetup{
            pdftitle={pybop : A hybrid python/C++ package for calculation of bond orientational order parameters},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{natbib}
\bibliographystyle{plainnat}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

% set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother


\title{pybop : A hybrid python/C++ package for calculation of bond
orientational order parameters}
\date{05 August 2019}

\begin{document}
\maketitle

\section{Summary}\label{summary}

Atomistic simulation methods are widely used in the study of condensed
matter systems, often producing large amounts of data in terms of atomic
positions over time. The analysis of this data to identify the local
atomic environment and determine whether a particle is part of a crystal
structure is a common challenge \citep{Stukowski:2012}.

A widely used approach to identify solid particles from liquid was
proposed by Auer and Frenkel \citep{Auer:2005}, which measures the
structural correlations between a particle and its neighbors and is
based on the bond orientational order parameters introduced by
Steinhardt et al. \citep{Steinhardt:1983}. These parameters are defined
by spherical harmonics in the local neighborhood of a particle within a
cutoff distance, and are rotationally and translationally invariant.
Steinhardt parameters have therefore been extensively used for the
identification of crystal structures \citep[ and references
within]{Mickel:2013}. At high temperatures, however, the atomic
positions are subject to thermal vibrations which leads to a broad
distribution of these parameters, and may result in poor resolution of
the crystal structures. An averaged version of the Steinhardt bond order
parameters introduced by Lechner and Dellago \citep{Lechner:2008} was
shown to improve accuracy in the identification of crystal structures at
finite temperatures. Another common problem at high temperatures is the
use of a fixed cutoff distance which can lead to an ambiguity in the
definition of the local neighborhood of a particle. An adaptive
definition of the local environment can be achieved by using a distinct
cutoff radius for each particle using methods such as the SANN algorithm
\citep{VanMeel:2012} or the adaptive common neighbor analysis
\citep{Stukowski:2012}. Additionally, Voronoi tessellation can be
employed for a parameter-free definition of the local neighborhood of a
particle. Mickel et al. showed \citep{Mickel:2013} that the
identification of crystal structures can be improved by weighting the
contribution of each neighbor to the Steinhardt parameters by the area
of the Voronoi facet shared between the atom and its neighbors. Further
approaches to improve the resolution of the crystal structures make use
of higher exponents of the area to weight the bond orientational order
parameters\citep{Haeberle:2019}.

Originally inspired by
\href{https://homepage.univie.ac.at/wolfgang.lechner/bondorderparameter.html}{\texttt{BondOrderAnalysis}}
\citep{Lechner:2010}, a C++ code for calculation of bond order
parameters, \texttt{pybop} is a python module designed for the
computation of bond orientational order parameters during
post-processing of simulation data. In addition to Steinhardt parameters
and their averaged version calculated by \texttt{BondOrderAnalysis},
\texttt{pybop} brings together the various approaches described above in
a single python module. While python offers the advantages of
extensibility and flexibility, the module ensures the speed and
efficiency of the calculations by using a core code written in C++,
which is then ported to python using \texttt{pybind11}
\citep{Jakob:2016}. The \texttt{pybop}module includes the following
functionality-

\begin{itemize}
\tightlist
\item
  calculation of Steinhardt bond orientational order parameters and
  their averaged version.
\item
  weighted bond order parameters using face area of voronoi polyhedra,
  the calculation of which is enabled using Voro++ code
  \citep{Rycroft:2009} integrated into \texttt{pybop}.
\item
  distinction of atoms as solid or liquid based on Frenkel and Auer
  approach \citep{Auer:2005}.
\item
  improvement of local neighborhood description using an adaptive cutoff
  distance.
\item
  clustering algorithm of particles based on a user defined property.
\item
  inbuilt functions for other structural features like radial
  distribution function, voronoi volume of individual particles and
  coordination number.
\item
  calculation of other Voronoi tessellation based parameters such as
  number of vertices and face area.
\end{itemize}

\texttt{pybop} uses a list of particle positions and simulation box
vectors as input. It can also read in output files containing atomistic
simulation data in the LAMMPS \citep{Plimpton:1995}
\href{https://lammps.sandia.gov/doc/dump.html}{dump format} and
\href{https://cms.mpi.univie.ac.at/vasp/vasp/POSCAR_file.html}{POSCAR}
format used by \emph{ab initio} simulation package
\href{https://www.vasp.at/}{VASP}. Orthogonal and triclinic simulation
cells can be employed in the module. \texttt{pybop} also offers a set of
supporting tools including those for reading, writing and splitting of
atomic trajectory files and the creation of perfect crystal structures.
Overall, \texttt{pybop} also acts as a tool for calculation of
quantities based on atomic positions, and can be easily extended using
either C++ for computationally intensive operations or python for other
tasks that wrap over the existing features. \texttt{pybop} includes a
documentation and various usage examples, available in the
\href{https://pybop.readthedocs.io/en/latest/}{pybop website}. Other
examples, including installation of the package and the calculation of
bond orientational order parameters, are also available. Alternatively,
\texttt{pybop} also provides a
\href{https://mybinder.org/v2/gh/srmnitc/pybop/master?filepath=examples\%2F}{binder
environment} to use the example cases before installation.

\section{Acknowledgements}\label{acknowledgements}

S.M. acknowledges a scholarship from the International Max Planck
Research School for Interface Controlled Materials for Energy
Conversion. G.D.L acknowledges the support by the Mexican National
Council for Science and Technology (CONACYT) through project 232090 and
by the German Research Foundation (DFG) through project RO 3073/6-1.

\renewcommand\refname{References}
\bibliography{paper.bib}

\end{document}
